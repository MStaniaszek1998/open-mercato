---
title: Module customization quickstart
description: Scaffold a new module with pages, APIs, entities, and dashboard widgets.
---

This tutorial walks through creating a `inventory_items` module that exposes backend pages, APIs, and dashboards.

## 1. Scaffold the module

```bash
mkdir -p packages/inventory/src/modules/inventory_items
touch packages/inventory/src/modules/inventory_items/{index.ts,di.ts,acl.ts}
```

Populate `index.ts` with metadata so the module shows up in registries:

```ts title="packages/inventory/src/modules/inventory_items/index.ts"
import type { ModuleInfo } from '@open-mercato/shared/modules/registry';

export const metadata: ModuleInfo = {
  id: 'inventory_items',
  title: 'Inventory Items',
  version: '0.1.0',
  description: 'Track purchasable stock and availability.',
};
```

Expose feature flags in `acl.ts`:

```ts title="packages/inventory/src/modules/inventory_items/acl.ts"
export const features = [
  'inventory_items.view',
  'inventory_items.create',
  'inventory_items.edit',
  'inventory_items.delete',
];
```

Finally register DI bindings in `di.ts`:

```ts title="packages/inventory/src/modules/inventory_items/di.ts"
import { asClass } from 'awilix';
import type { AppContainer } from '@open-mercato/shared/lib/di/container';
import { InventoryService } from './services/inventory-service';

export function register(container: AppContainer) {
  container.register({
    inventoryService: asClass(InventoryService).scoped(),
  });
}
```

## 2. Add backend pages

Create `backend/items/page.tsx` to list items and `backend/items/create/page.tsx` for the form. Pages automatically pick up metadata via adjacent `page.meta.ts` files:

```ts title="backend/items/page.meta.ts"
import type { PageMetadata } from '@open-mercato/shared/modules/registry';

export const metadata: PageMetadata = {
  title: 'Inventory',
  requireAuth: true,
  requireFeatures: ['inventory_items.view'],
  group: 'Inventory',
  order: 10,
};
```

Use the shared UI building blocks such as `AppShell`, `DataGrid`, and `CrudForm` to ship polished admin experiences with minimal boilerplate.

## 3. Compose APIs with the CRUD factory

Add `api/items/route.ts` and reuse the [CRUD factory](../../framework/api/crud-factory) for consistent behaviour. All validation should live in `data/validators.ts` next to your entities.

## 4. Register entities and migrations

- Define MikroORM entities under `data/entities.ts`.
- Optional extensions go in `data/extensions.ts`.
- Run `npm run modules:prepare` followed by `npm run db:generate` to materialise migrations.

## 5. Ship dashboards or subscribers

- Add widgets under `widgets/dashboard/<slug>/widget.ts` to expose module KPIs.
- Create `subscribers/*.ts` to react to events emitted by other modules.

When you are done, enable the module in `src/modules.ts`, re-run `npm run modules:prepare`, and restart the dev server. Your new module is now discoverable everywhere: UIs, APIs, DI, and entity registries.
